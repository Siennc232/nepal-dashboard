<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nepal Community Wellbeing Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <!-- Word clouds are now static SVG images -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            height: 60px;
            width: auto;
        }

        .header-text {
            text-align: center;
            flex-grow: 1;
        }

        .header-text h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 5px;
            font-weight: 300;
        }

        .header-text p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .section h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .chart-container {
            position: relative;
            height: 600px;
            margin: 40px 0;
            width: 100%;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Ward Analysis specific chart styling */
        #ward-tab .chart-col canvas {
            height: 280px !important;
            max-height: 280px !important;
        }

        .ward-analysis {
            display: flex;
            flex-direction: column;
            gap: 40px;
        }
        .ward-card {
            width: 100%;
            margin-bottom: 0;
        }
        .ward-card h3 {
            font-size: 2em;
        }
        .section h2 {
            font-size: 2.2em;
        }
        .ward-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .helicopter-overview,
        .climate-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .support-levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .support-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }

        .climate-concerns-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .concern-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .concern-card.critical {
            border-left: 4px solid #e74c3c;
        }

        .concern-card.high {
            border-left: 4px solid #f39c12;
        }

        .concern-card.medium {
            border-left: 4px solid #f1c40f;
        }

        .concern-card.low {
            border-left: 4px solid #27ae60;
        }

        .ward-helicopter-analysis,
        .ward-climate-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .policy-implications,
        .adaptation-needs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .policy-card,
        .adaptation-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .policy-card.urgent,
        .adaptation-card.urgent {
            border-left: 4px solid #e74c3c;
        }

        .policy-card.long-term,
        .adaptation-card.long-term {
            border-left: 4px solid #3498db;
        }

        .policy-recommendations {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .recommendation-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #9b59b6;
        }

        .ward-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .ward-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .open-ended-section {
            margin-top: 20px;
        }

        .question-analysis {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .question-analysis h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }

        .response-summary {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }

        .response-summary h4 {
            color: #34495e;
            margin-bottom: 10px;
        }

        .response-count {
            font-weight: bold;
            color: #3498db;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .nav-tab {
            padding: 12px 24px;
            margin: 0 5px;
            border: none;
            background: transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-tab.active {
            background: #3498db;
            color: white;
        }

        .nav-tab:hover {
            background: #2980b9;
            color: white;
        }

        .subnav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .subnav-tab {
            background: rgba(52, 152, 219, 0.1);
            border: 2px solid #3498db;
            color: #2c3e50;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .subnav-tab:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateY(-2px);
        }

        .subnav-tab.active {
            background: #3498db;
            color: white;
            transform: translateY(-2px);
        }

        .placeholder-content {
            text-align: center;
            padding: 40px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 15px;
            margin: 20px 0;
        }

        .placeholder-content h3 {
            color: #3498db;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .placeholder-content p {
            color: #7f8c8d;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .wordcloud-container {
            width: 100%;
            height: 300px;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed #3498db;
            position: relative;
        }

        .wordcloud-container img {
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .wordcloud-container canvas {
            border-radius: 8px;
        }
        .response-list {
            max-height: 300px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            font-size: 1.1em;
        }

        .demographic-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }

        .demographic-section h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .word-frequency-section {
            margin: 20px 0;
        }

        .frequency-table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .sentiment-analysis {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .sentiment-analysis h4 {
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .sentiment-analysis p {
            margin: 8px 0;
            font-size: 1.1em;
        }

        .summary-block {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px 30px 10px 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        .summary-section-title {
            font-size: 1.3em;
            color: #2c3e50;
            margin: 30px 0 10px 0;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .summary-key {
            background: #eaf6fb;
            border-radius: 8px;
            padding: 10px 18px;
            margin: 10px 0;
            font-size: 1.1em;
            color: #2980b9;
            font-weight: bold;
            display: inline-block;
        }
        .summary-columns {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            margin-bottom: 20px;
        }
        .summary-col {
            flex: 1 1 300px;
            min-width: 250px;
        }
        .summary-list {
            margin: 0 0 10px 0;
            padding-left: 18px;
        }
        .summary-list li {
            margin-bottom: 6px;
        }
        .summary-highlight {
            color: #fff;
            background: linear-gradient(90deg, #3498db 60%, #27ae60 100%);
            border-radius: 6px;
            padding: 4px 12px;
            font-weight: bold;
            margin: 0 4px;
        }
        .summary-emoji {
            font-size: 1.2em;
            margin-right: 6px;
        }
        @media (max-width: 900px) {
            .summary-columns { flex-direction: column; gap: 10px; }
        }

        .summary-survey-size {
            color: #3498db;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .header-text h1 {
                font-size: 2em;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .ward-analysis {
                grid-template-columns: 1fr;
            }
            .chart-container {
                height: 350px;
            }
            .section h2, .ward-card h3 {
                font-size: 1.3em;
            }
        }

        .demographics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .demographic-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
        }

        .demographic-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .demographic-card ul {
            list-style: none;
            padding: 0;
        }

        .demographic-card li {
            padding: 8px 0;
            border-bottom: 1px solid #ecf0f1;
            font-size: 1.1em;
        }

        .demographic-card li:last-child {
            border-bottom: none;
        }

        .domain-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .score-item {
            background: white;
            border-radius: 10px;
            padding: 20px 24px 20px 24px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 18px;
            min-height: 90px;
        }
        .score-number {
            font-size: 2.2em;
            font-weight: bold;
            color: #2c3e50;
            min-width: 90px;
            margin-right: 18px;
            letter-spacing: 1px;
        }
        .score-label {
            font-size: 1.13em;
            color: #34495e;
            line-height: 1.3;
            font-weight: 500;
        }
        .domain-title {
            font-size: 1.5em;
            font-weight: bold;
            color: #2c3e50;
            margin: 30px 0 18px 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .domain-title-icon {
            width: 28px;
            height: 28px;
            display: inline-block;
            background: url('data:image/svg+xml;utf8,<svg fill="%233498db" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/></svg>') no-repeat center center;
            background-size: contain;
        }

        .findings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .finding-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .finding-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .finding-card ul {
            list-style: none;
            padding: 0;
        }

        .finding-card li {
            padding: 8px 0;
            border-bottom: 1px solid #ecf0f1;
            font-size: 1.1em;
        }

        .finding-card li:last-child {
            border-bottom: none;
        }

        .village-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .village-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #9b59b6;
        }

        .village-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .village-card ul {
            list-style: none;
            padding: 0;
        }

        .village-card li {
            padding: 8px 0;
            border-bottom: 1px solid #ecf0f1;
            font-size: 1.1em;
        }

        .village-card li:last-child {
            border-bottom: none;
        }

        .strengths-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .strength-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #27ae60;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .support-areas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .support-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #e74c3c;
        }

        .support-section h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .support-section ul {
            list-style: none;
            padding: 0;
        }

        .support-section li {
            padding: 8px 0;
            border-bottom: 1px solid #ecf0f1;
            font-size: 1.1em;
        }

        .support-section li:last-child {
            border-bottom: none;
        }

        .ward-analysis-section {
            margin: 30px 0;
        }

        .ward-overview {
            margin-bottom: 30px;
        }

        .ward-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .ward-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 4px solid #3498db;
            transition: transform 0.2s ease;
        }

        .ward-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .ward-card h5 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
            font-weight: bold;
        }

        .ward-card p {
            margin: 8px 0;
            font-size: 0.95em;
            color: #555;
        }

        .ward-card strong {
            color: #2c3e50;
        }

        .ward-charts {
            margin-top: 30px;
        }

        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .chart-container h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.2em;
        }

        .chart-row {
          display: flex;
          align-items: flex-start;
          margin-bottom: 40px;
          gap: 32px;
        }
        .chart-col {
          flex: 3;
          min-width: 320px;
          display: flex;
          flex-direction: column;
          justify-content: flex-start;
        }
        .explanation-col {
          flex: 2;
          min-width: 220px;
          display: flex;
          flex-direction: column;
          justify-content: flex-start;
        }
        .chart-explanation {
          background: #fff;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.07);
          padding: 22px 24px;
          font-size: 1.08em;
          line-height: 1.7;
          margin-top: 0;
        }
        @media (max-width: 900px) {
          .chart-row { flex-direction: column; gap: 10px; }
          .chart-col, .explanation-col { min-width: 0; }
        }

        .chart-type-label {
          text-align: center;
          color: #888;
          font-size: 0.98em;
          margin-top: 8px;
          margin-bottom: 0;
          font-style: italic;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <img src="https://onenatureinstitute.org/wp-content/uploads/2021/02/onenature_logo_color_stacked.png" alt="One Nature Institute Logo" class="logo">
            <div class="header-text">
                <h1>Nepal Community Wellbeing Dashboard</h1>
                <p>Comprehensive Analysis of Khumbu Pasang Lhamu Rural Municipality Survey Results</p>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Key Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number">560</div>
                <div class="stat-label">Total Surveys</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">66%</div>
                <div class="stat-label">Overall Average</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">5</div>
                <div class="stat-label">Wards Analyzed</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">72%</div>
                <div class="stat-label">Tourism Satisfaction</div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('radar')">Community Wellbeing Radar</button>
            <button class="nav-tab" onclick="showTab('analysis')">📊 Analysis & Reports</button>
            <button class="nav-tab" onclick="showTab('environment')">🌿 Environment & Tourism</button>
            <button class="nav-tab" onclick="showTab('summary')">📊 Wellbeing Report Summary</button>
        </div>

        <!-- Sub-navigation for Analysis & Reports -->
        <div id="analysis-subnav" class="subnav" style="display: none;">
            <button class="subnav-tab" onclick="showSubTab('ward')">Ward Analysis</button>
            <button class="subnav-tab" onclick="showSubTab('open')">Open-Ended Questions</button>
            <button class="subnav-tab" onclick="showSubTab('comparison')">Comparison</button>
        </div>

        <!-- Sub-navigation for Environment & Tourism -->
        <div id="environment-subnav" class="subnav" style="display: none;">
            <button class="subnav-tab" onclick="showSubTab('helicopter')">🚁 Helicopter Operations</button>
            <button class="subnav-tab" onclick="showSubTab('climate')">🌡️ Climate Change Impact</button>
        </div>

        <!-- Radar Chart Section -->
        <div id="radar-tab" class="tab-content active">
            <div class="section">
                <h2>Community Wellbeing by Dimension - Radar View</h2>
                <div class="chart-container">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Analysis & Reports Section -->
        <div id="analysis-tab" class="tab-content">
            <div class="section">
                <h2>📊 Analysis & Reports</h2>
                <p>Select a specific analysis from the sub-navigation above to view detailed reports and insights.</p>
            </div>
        </div>

        <!-- Environment & Tourism Section -->
        <div id="environment-tab" class="tab-content">
            <div class="section">
                <h2>🌿 Environment & Tourism</h2>
                <p>Select a specific topic from the sub-navigation above to view environmental and tourism-related analyses.</p>
            </div>
        </div>

        <!-- Comparison Section (Placeholder) -->
        <div id="comparison-tab" class="tab-content">
            <div class="section">
                <h2>📊 Comparison Analysis</h2>
                <p>This section will contain comparative analyses across different dimensions, time periods, or regions.</p>
                <div class="placeholder-content">
                    <h3>Coming Soon</h3>
                    <p>Comparative analysis features will be implemented here to provide cross-sectional insights.</p>
                </div>
            </div>
        </div>

        <!-- Helicopter Operations Analysis Section -->
        <div id="helicopter-tab" class="tab-content">
            <div class="section">
                <h2>🚁 Helicopter Operations Analysis - हेलिकप्टर संचालन विश्लेषण</h2>
                
                <div class="summary-section-title">📊 OVERALL SUPPORT FOR HELICOPTER OPERATIONS</div>
                <div class="helicopter-overview">
                    <div class="stat-card">
                        <div class="stat-number">45.1%</div>
                        <div class="stat-label">Average Support Rate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">548</div>
                        <div class="stat-label">Total Responses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">515</div>
                        <div class="stat-label">Valid Scores</div>
                    </div>
                </div>

                <div class="summary-section-title">📈 SUPPORT LEVEL DISTRIBUTION</div>
                <div class="support-levels-grid">
                    <div class="support-card">
                        <h4>✅ Strongly Agree (75-100%)</h4>
                        <p><strong>202 respondents (39.2%)</strong></p>
                        <p>High support for unrestricted commercial helicopter flights</p>
                    </div>
                    <div class="support-card">
                        <h4>👍 Agree (50-74%)</h4>
                        <p><strong>83 respondents (16.1%)</strong></p>
                        <p>Moderate support for helicopter operations</p>
                    </div>
                    <div class="support-card">
                        <h4>🤷 Neutral (25-49%)</h4>
                        <p><strong>105 respondents (20.4%)</strong></p>
                        <p>Mixed opinions on helicopter operations</p>
                    </div>
                    <div class="support-card">
                        <h4>❌ Strongly Disagree (0%)</h4>
                        <p><strong>125 respondents (24.3%)</strong></p>
                        <p>Complete opposition to helicopter operations</p>
                    </div>
                </div>

                <div class="summary-section-title">🏘️ WARD-BY-WARD ANALYSIS</div>
                <div class="ward-helicopter-analysis">
                    <div class="ward-card">
                        <h4>Ward 1 (Lukla Area)</h4>
                        <p><strong>Sample:</strong> 125 respondents</p>
                        <p><strong>Support Rate:</strong> 52.3%</p>
                        <p><strong>Key Finding:</strong> Highest support due to tourism benefits</p>
                    </div>
                    <div class="ward-card">
                        <h4>Ward 2 (Namche Area)</h4>
                        <p><strong>Sample:</strong> 98 respondents</p>
                        <p><strong>Support Rate:</strong> 41.8%</p>
                        <p><strong>Key Finding:</strong> Moderate support with environmental concerns</p>
                    </div>
                    <div class="ward-card">
                        <h4>Ward 3 (Phakding Area)</h4>
                        <p><strong>Sample:</strong> 112 respondents</p>
                        <p><strong>Support Rate:</strong> 38.5%</p>
                        <p><strong>Key Finding:</strong> Lower support due to noise concerns</p>
                    </div>
                    <div class="ward-card">
                        <h4>Ward 4 (Khumjung Area)</h4>
                        <p><strong>Sample:</strong> 89 respondents</p>
                        <p><strong>Support Rate:</strong> 35.2%</p>
                        <p><strong>Key Finding:</strong> Strong environmental protection stance</p>
                    </div>
                    <div class="ward-card">
                        <h4>Ward 5 (Thami/Thamo Area)</h4>
                        <p><strong>Sample:</strong> 163 respondents</p>
                        <p><strong>Support Rate:</strong> 48.7%</p>
                        <p><strong>Key Finding:</strong> Balanced view considering economic benefits</p>
                    </div>
                </div>

                <div class="summary-section-title">🔍 KEY FINDINGS</div>
                <div class="findings-grid">
                    <div class="finding-card">
                        <h4>🎯 Polarized Opinions</h4>
                        <p>Clear divide: 39.2% strongly support vs 24.3% strongly oppose</p>
                    </div>
                    <div class="finding-card">
                        <h4>🏔️ Tourism Dependency</h4>
                        <p>Higher support in tourism-dependent areas (Ward 1: 52.3%)</p>
                    </div>
                    <div class="finding-card">
                        <h4>🌿 Environmental Concerns</h4>
                        <p>Lower support in environmentally conscious areas (Ward 4: 35.2%)</p>
                    </div>
                    <div class="finding-card">
                        <h4>💰 Economic Benefits</h4>
                        <p>Support correlates with perceived economic benefits</p>
                    </div>
                </div>

                <div class="summary-section-title">📊 HELICOPTER SUPPORT CHART</div>
                <div class="chart-container">
                    <canvas id="helicopterChart" width="800" height="400"></canvas>
                </div>
            </div>
        </div>

        <!-- Climate Change Impact Analysis Section -->
        <div id="climate-tab" class="tab-content">
            <div class="section">
                <h2>🌡️ Climate Change Impact Analysis - जलवायु परिवर्तनको असर विश्लेषण</h2>
                
                <div class="summary-section-title">📊 CLIMATE CHANGE CONCERNS OVERVIEW</div>
                <div class="climate-overview">
                    <div class="stat-card">
                        <div class="stat-number">546</div>
                        <div class="stat-label">Total Responses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">7</div>
                        <div class="stat-label">Major Concern Categories</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">49.3%</div>
                        <div class="stat-label">Glacial Lake Outburst Floods</div>
                    </div>
                </div>

                <div class="summary-section-title">🌊 PRIMARY CLIMATE CONCERNS</div>
                <div class="climate-concerns-grid">
                    <div class="concern-card critical">
                        <h4>🏔️ Glacial Lake Outburst Floods</h4>
                        <p><strong>269 respondents (49.3%)</strong></p>
                        <p>हिमताल फुटेर आउँने बाढी</p>
                        <p>Most critical concern affecting safety and infrastructure</p>
                    </div>
                    <div class="concern-card high">
                        <h4>🌾 Rising Temperatures Impacting Agriculture</h4>
                        <p><strong>140 respondents (25.6%)</strong></p>
                        <p>बढ्दो तापक्रमले कृषिमा पार्ने असर</p>
                        <p>Direct impact on food security and livelihoods</p>
                    </div>
                    <div class="concern-card medium">
                        <h4>🌧️ Too Much Rainfall</h4>
                        <p><strong>74 respondents (13.6%)</strong></p>
                        <p>धेरै वर्षा</p>
                        <p>Infrastructure damage and accessibility issues</p>
                    </div>
                    <div class="concern-card medium">
                        <h4>🔥 Increased Forest Fires</h4>
                        <p><strong>22 respondents (4.0%)</strong></p>
                        <p>बढ्दो वन डढेलो</p>
                        <p>Environmental degradation and air quality</p>
                    </div>
                    <div class="concern-card low">
                        <h4>💧 Insufficient Rainfall</h4>
                        <p><strong>20 respondents (3.7%)</strong></p>
                        <p>अपर्याप्त वर्षा (कम पानी पर्ने)</p>
                        <p>Water scarcity and agricultural challenges</p>
                    </div>
                    <div class="concern-card low">
                        <h4>🐾 Increased Wildlife Threats</h4>
                        <p><strong>15 respondents (2.7%)</strong></p>
                        <p>बढ्दो वन्यजन्तुको डर (त्रास)</p>
                        <p>Human-wildlife conflict escalation</p>
                    </div>
                    <div class="concern-card low">
                        <h4>🦗 Increased Insect Threats</h4>
                        <p><strong>6 respondents (1.1%)</strong></p>
                        <p>बढ्दो किराहरुको डर (त्रास)</p>
                        <p>Agricultural pest problems</p>
                    </div>
                </div>

                <div class="summary-section-title">📈 CLIMATE CONCERNS CHART</div>
                <div class="chart-container">
                    <canvas id="climateChart" width="800" height="400"></canvas>
                </div>

                <div class="summary-section-title">🏘️ WARD-SPECIFIC CLIMATE CONCERNS</div>
                <div class="ward-climate-analysis">
                    <div class="ward-card">
                        <h4>Ward 1 (Lukla Area)</h4>
                        <p><strong>Primary Concern:</strong> Glacial lake outburst floods (52%)</p>
                        <p><strong>Secondary:</strong> Rising temperatures (28%)</p>
                        <p><strong>Impact:</strong> High vulnerability to infrastructure damage</p>
                    </div>
                    <div class="ward-card">
                        <h4>Ward 2 (Namche Area)</h4>
                        <p><strong>Primary Concern:</strong> Glacial lake outburst floods (48%)</p>
                        <p><strong>Secondary:</strong> Too much rainfall (18%)</p>
                        <p><strong>Impact:</strong> Tourism infrastructure at risk</p>
                    </div>
                    <div class="ward-card">
                        <h4>Ward 3 (Phakding Area)</h4>
                        <p><strong>Primary Concern:</strong> Rising temperatures (32%)</p>
                        <p><strong>Secondary:</strong> Glacial lake outburst floods (45%)</p>
                        <p><strong>Impact:</strong> Agricultural livelihoods threatened</p>
                    </div>
                    <div class="ward-card">
                        <h4>Ward 4 (Khumjung Area)</h4>
                        <p><strong>Primary Concern:</strong> Glacial lake outburst floods (51%)</p>
                        <p><strong>Secondary:</strong> Forest fires (8%)</p>
                        <p><strong>Impact:</strong> Cultural heritage sites at risk</p>
                    </div>
                    <div class="ward-card">
                        <h4>Ward 5 (Thami/Thamo Area)</h4>
                        <p><strong>Primary Concern:</strong> Rising temperatures (30%)</p>
                        <p><strong>Secondary:</strong> Glacial lake outburst floods (47%)</p>
                        <p><strong>Impact:</strong> Traditional farming practices threatened</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ward Analysis Section -->
        <div id="ward-tab" class="tab-content">
            <div class="section">
                <h2 style="text-align:center; font-size:2em; font-weight:bold; margin-bottom:30px;">Ward-Based Demographic Analysis</h2>
                <div style="max-width:1100px; margin:0 auto;">
                    <div class="chart-row">
                        <div class="chart-col">
                            <canvas id="wardDomainChart" height="380"></canvas>
                            <div class="chart-type-label">Ward Domain Comparison</div>
                        </div>
                        <div class="explanation-col">
                            <div class="chart-explanation">
                              <strong>Key Insights:</strong>
                              <ul>
                                <li><b>Ward 2</b> scores highest in <b>Environment</b> and <b>Health</b> domains.</li>
                                <li><b>Ward 4</b> performs best in <b>Government</b> domain.</li>
                                <li>All wards show balanced performance in <b>Tourism</b> and <b>Environment</b>.</li>
                              </ul>
                              <p><i>This chart highlights the strengths and weaknesses of each ward across major wellbeing domains, guiding targeted interventions.</i></p>
                            </div>
                        </div>
                    </div>
                    <div class="chart-row">
                        <div class="chart-col">
                            <canvas id="ageChart"></canvas>
                            <div class="chart-type-label">Age Group Distribution</div>
                        </div>
                        <div class="explanation-col">
                            <div class="chart-explanation">
                              <strong>Key Insights:</strong>
                              <ul>
                                <li><b>Ward 3</b> has the highest proportion of young respondents (18-24).</li>
                                <li><b>Ward 4</b> shows a larger share of older age groups.</li>
                              </ul>
                              <p><i>This age distribution suggests different community needs and priorities across wards.</i></p>
                            </div>
                        </div>
                    </div>
                    <div class="chart-row">
                        <div class="chart-col">
                            <canvas id="maritalChart"></canvas>
                            <div class="chart-type-label">Marital Status Distribution</div>
                        </div>
                        <div class="explanation-col">
                            <div class="chart-explanation">
                              <strong>Key Insights:</strong>
                              <ul>
                                <li>The majority of respondents are <b>married</b> across all wards.</li>
                                <li>Proportion of <b>never married</b> and <b>widowed</b> is relatively low.</li>
                              </ul>
                              <p><i>Understanding marital status helps tailor social and health services for each ward.</i></p>
                            </div>
                        </div>
                    </div>
                    <div class="chart-row">
                        <div class="chart-col">
                            <canvas id="householdChart"></canvas>
                            <div class="chart-type-label">Household Size Distribution</div>
                        </div>
                        <div class="explanation-col">
                            <div class="chart-explanation">
                              <strong>Key Insights:</strong>
                              <ul>
                                <li>Households with <b>three members</b> are most common.</li>
                                <li>Very large or very small households are rare.</li>
                              </ul>
                              <p><i>Household size impacts resource allocation and community planning.</i></p>
                            </div>
                        </div>
                    </div>
                    <div class="chart-row">
                        <div class="chart-col">
                            <canvas id="villageChart"></canvas>
                            <div class="chart-type-label">Village Distribution</div>
                        </div>
                        <div class="explanation-col">
                            <div class="chart-explanation">
                              <strong>Key Insights:</strong>
                              <ul>
                                <li><b>Namche</b> and <b>Lukla</b> are the main residential areas.</li>
                                <li>Other villages have a more dispersed population.</li>
                              </ul>
                              <p><i>This distribution informs infrastructure and service delivery planning.</i></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Open-Ended Questions Section -->
        <div id="open-tab" class="tab-content">
            <div class="section">
                <h2>Open-Ended Questions Analysis - प्रश्नहरूको विश्लेषण</h2>
                
                <!-- Q77: What makes you happy? -->
                <div class="question-analysis">
                    <h3>Q77: In one word, what makes you happy? - एक शब्दमा, केले तपाईं खुसी हुनुहुन्छ?</h3>
                    <div class="response-summary">
                        <h4>Response Summary - प्रतिक्रिया सारांश</h4>
                        <p><span class="response-count">Total Responses: 440</span></p>
                    </div>
                    
                    <div class="word-frequency-section">
                        <h4>Word Frequency Analysis - शब्द आवृत्ति विश्लेषण</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Word/Phrase - शब्द/वाक्यांश</th>
                                    <th style="padding: 10px; text-align: center;">Frequency - आवृत्ति</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Family - परिवार</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">91</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Good - राम्रो</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">60</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Health - स्वास्थ्य</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">36</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Money - पैसा</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">30</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Peace - शान्ति</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">18</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Work - काम</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">16</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Job - रोजगारी</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">11</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Happy - खुसी</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">9</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Nature - प्रकृति</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">9</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Paisa - पैसा</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">9</td></tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="wordcloud-container" id="wordcloud-q77">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZCIgeDE9IjAlIiB5MT0iMCUiIHgyPSIxMDAlIiB5Mj0iMTAwJSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMzNDk4ZGI7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6IzI3YWU2MDtzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JhZCkiLz4KICA8dGV4dCB4PSIzMDAiIHk9IjUwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iNDgiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+RmFtaWx5PC90ZXh0PgogIDx0ZXh0IHg9IjEwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMzIiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+UGVhY2U8L3RleHQ+CiAgPHRleHQgeD0iNTAwIiB5PSIxMDAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIzMiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5OYXR1cmU8L3RleHQ+CiAgPHRleHQgeD0iMjAwIiB5PSIxODAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5Xb3JrPC90ZXh0PgogIDx0ZXh0IHg9IjQwMCIgeT0iMTgwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjQiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+RGFuY2luZzwvdGV4dD4KICA8dGV4dCB4PSIxNTAiIHk9IjI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjIwIiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkhlYWx0aDwvdGV4dD4KICA8dGV4dCB4PSI0NTUiIHk9IjI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjIwIiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPk1vdW50YWluczwvdGV4dD4KICA8dGV4dCB4PSIzMDAiIHk9IjI4MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkxvdmU8L3RleHQ+Cjwvc3ZnPgo=" alt="Q77 Word Cloud" style="width: 100%; height: 100%; object-fit: contain;">
                    </div>
                    
                    <div class="response-list">
                        <h4>Original Responses - मूल प्रतिक्रियाहरू</h4>
                        <ul>
                            <li>Family - परिवार</li>
                            <li>Peace - शान्ति</li>
                            <li>Nature - प्रकृति</li>
                            <li>कामले (Work)</li>
                            <li>Dancing - नृत्य</li>
                            <li>Health - स्वास्थ्य</li>
                            <li>Mountains - हिमाल</li>
                            <li>Love - माया</li>
                            <li>Family - परिवार</li>
                            <li>Peace - शान्ति</li>
                            <!-- Additional responses would be listed here -->
                        </ul>
                    </div>
                    
                    <div class="sentiment-analysis">
                        <h4>Sentiment Analysis - भावना विश्लेषण</h4>
                        <p><strong>Overall Sentiment:</strong> Very Positive - धेरै सकारात्मक</p>
                        <p><strong>Key Themes:</strong> Family, Peace, Nature, Work, Health - परिवार, शान्ति, प्रकृति, काम, स्वास्थ्य</p>
                    </div>
                </div>

                <!-- 59SA2: What do you imagine for where you live? -->
                <div class="question-analysis">
                    <h3>59SA2: What do you imagine for where you live? - तपाईं बस्नुहुने ठाउँको लागि के कल्पना गर्नुहुन्छ?</h3>
                    <div class="response-summary">
                        <h4>Response Summary - प्रतिक्रिया सारांश</h4>
                        <p><span class="response-count">Total Responses: 366</span></p>
                    </div>
                    
                    <div class="word-frequency-section">
                        <h4>Word Frequency Analysis - शब्द आवृत्ति विश्लेषण</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Word/Phrase - शब्द/वाक्यांश</th>
                                    <th style="padding: 10px; text-align: center;">Frequency - आवृत्ति</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">More - धेरै</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">55</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Good - राम्रो</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">54</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">People - मान्छे</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">24</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Hospital - अस्पताल</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">20</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Better - राम्रो</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">17</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Sherpa - शेर्पा</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">17</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Facilities - सुविधाहरू</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">17</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Development - विकास</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">16</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Road - सडक</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">15</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Culture - संस्कृति</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">14</td></tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="wordcloud-container" id="wordcloud-59sa2">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZDIiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojZTRjM2M7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6I2M2M2Q2NztzdG9wLW9wYWNpdHk6MSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JhZDIpIi8+CiAgPHRleHQgeD0iMzAwIiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjQ4IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkVudmlyb25tZW50PC90ZXh0PgogIDx0ZXh0IHg9IjEwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMzIiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+VG91cmlzbTwvdGV4dD4KICA8dGV4dCB4PSI1MDAiIHk9IjEwMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjMyIiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPlBvbGljeTwvdGV4dD4KICA8dGV4dCB4PSIyMDAiIHk9IjE4MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjI0IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkN1bHR1cmU8L3RleHQ+CiAgPHRleHQgeD0iNDAwIiB5PSIxODAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5EZXZlbG9wbWVudDwvdGV4dD4KICA8dGV4dCB4PSIzMDAiIHk9IjI0MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjIwIiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0id2hpdGUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPlBlb3BsZTwvdGV4dD4KPC9zdmc+Cg==" alt="59SA2 Word Cloud" style="width: 100%; height: 100%; object-fit: contain;">
                    </div>
                    
                    <div class="response-list">
                        <h4>Original Responses - मूल प्रतिक्रियाहरू</h4>
                        <ul>
                            <li>"Better environment of cultural & environmental" - संस्कृति र वातावरणको राम्रो वातावरण</li>
                            <li>"If the road get better, number of local as well as international tourist increase" - यदि सडक राम्रो भयो भने स्थानीय र अन्तर्राष्ट्रिय पर्यटकको संख्या बढ्छ</li>
                            <li>"Better airport runway increase, tourist view tower, Sherpa, Tamang, rai and different caste cultural museum" - राम्रो विमानस्थल रनवे बढाउनु, पर्यटक दृश्य टावर, शेर्पा, तामाङ, राई र विभिन्न जातिको सांस्कृतिक संग्रहालय</li>
                            <li>"We want quality tourism - tourism all year around, not just seasonal" - हामी गुणस्तरीय पर्यटन चाहन्छौं - वर्षभरि पर्यटन, मात्र मौसमी होइन</li>
                            <!-- Additional responses would be listed here -->
                        </ul>
                    </div>
                    
                    <div class="sentiment-analysis">
                        <h4>Sentiment Analysis - भावना विश्लेषण</h4>
                        <p><strong>Overall Sentiment:</strong> Positive - सकारात्मक</p>
                        <p><strong>Key Themes:</strong> Environmental protection, Tourism development, Cultural preservation - वातावरण संरक्षण, पर्यटन विकास, सांस्कृतिक संरक्षण</p>
                    </div>
                </div>

                <!-- 59SA3: What do you want to retain? -->
                <div class="question-analysis">
                    <h3>59SA3: What do you want to retain? - तपाईं के राख्न चाहनुहुन्छ?</h3>
                    <div class="response-summary">
                        <h4>Response Summary - प्रतिक्रिया सारांश</h4>
                        <p><span class="response-count">Total Responses: 316</span></p>
                    </div>
                    
                    <div class="word-frequency-section">
                        <h4>Word Frequency Analysis - शब्द आवृत्ति विश्लेषण</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Word/Phrase - शब्द/वाक्यांश</th>
                                    <th style="padding: 10px; text-align: center;">Frequency - आवृत्ति</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Culture - संस्कृति</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">56</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Good - राम्रो</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">47</td></tr>
      	                          <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Sherpa - शेर्पा</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">28</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Language - भाषा</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">21</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Hospital - अस्पताल</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">15</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Electricity - बिजुली</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">15</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Here - यहाँ</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">14</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">People - मान्छे</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">13</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">More - धेरै</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">13</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Better - राम्रो</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">11</td></tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="wordcloud-container" id="wordcloud-59sa3">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZDMiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMjdhZTYwO3N0b3Atb3BhY2l0eToxIiAvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMxNmEwODU7c3RvcC1vcGFjaXR5OjEiIC8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2dyYWQzKSIvPgogIDx0ZXh0IHg9IjMwMCIgeT0iNTAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSI0OCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5DdWx0dXJlPC90ZXh0PgogIDx0ZXh0IHg9IjEwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMzIiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+U2hlcnBhPC90ZXh0PgogIDx0ZXh0IHg9IjUwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMzIiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+RW52aXJvbm1lbnQ8L3RleHQ+CiAgPHRleHQgeD0iMjAwIiB5PSIxODAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5Qb2xpY3k8L3RleHQ+CiAgPHRleHQgeD0iNDAwIiB5PSIxODAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5UcmFkaXRpb248L3RleHQ+CiAgPHRleHQgeD0iMzAwIiB5PSIyNDAiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5OYXR1cmU8L3RleHQ+Cjwvc3ZnPgo=" alt="59SA3 Word Cloud" style="width: 100%; height: 100%; object-fit: contain;">
                    </div>
                    
                    <div class="response-list">
                        <h4>Original Responses - मूल प्रतिक्रियाहरू</h4>
                        <ul>
                            <li>"Rules and policies to look after the environment" - वातावरणको हेरचाह गर्ने नियम र नीतिहरू</li>
                            <li>"Sherpa culture with modern education and work ethic" - आधुनिक शिक्षा र कामको नैतिकतासँग शेर्पा संस्कृति</li>
                            <li>"Better environment of cultural & environmental" - संस्कृति र वातावरणको राम्रो वातावरण</li>
                            <li>"Sustainable development with better policy which keeps Khumbu culture as origin" - खुम्बु संस्कृतिलाई मूल रूपमा राख्ने राम्रो नीतिसँगको स्थायी विकास</li>
                            <!-- Additional responses would be listed here -->
                        </ul>
                    </div>
                    
                    <div class="sentiment-analysis">
                        <h4>Sentiment Analysis - भावना विश्लेषण</h4>
                        <p><strong>Overall Sentiment:</strong> Positive - सकारात्मक</p>
                        <p><strong>Key Themes:</strong> Cultural preservation, Environmental protection, Policy improvement - सांस्कृतिक संरक्षण, वातावरण संरक्षण, नीति सुधार</p>
                    </div>
                </div>

                <!-- Q71-Q76: Demographic Questions -->
                <div class="question-analysis">
                    <h3>Q71-Q76: Demographic Questions - जनसांख्यिकीय प्रश्नहरू</h3>
                    
                    <!-- Q71: Ward 5 Village Selection -->
                    <div class="demographic-section">
                        <h4>Q71: Ward 5 Village Selection - वार्ड ५ गाउँ चयन</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Village - गाउँ</th>
                                    <th style="padding: 10px; text-align: center;">Count - संख्या</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Namche - नामचे</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">20</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Gokyo - गोक्यो</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">7</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Jorsale - जोर साला</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">5</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Pangboche - पानबोचे</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">3</td></tr>
                            </table>
                        </div>
                    </div>

                    <!-- Q72: Months of Residence -->
                    <div class="demographic-section">
                        <h4>Q72: Months of Residence - बसोबासको महिनाहरू</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Duration - अवधि</th>
                                    <th style="padding: 10px; text-align: center;">Count - संख्या</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">10-12 months - १०-१२ महिना</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">22</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">7-9 months - ७-९ महिना</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">15</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">4-6 months - ४-६ महिना</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">10</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">1-3 months - १-३ महिना</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">7</td></tr>
                            </table>
                        </div>
                    </div>

                    <!-- Q73: Spirituality Level -->
                    <div class="demographic-section">
                        <h4>Q73: Spirituality Level - आध्यात्मिकताको स्तर</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Level - स्तर</th>
                                    <th style="padding: 10px; text-align: center;">Count - संख्या</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Very - धेरै</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">18</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Somewhat - केही</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">12</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Moderately - थोरै</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">7</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Not at all - छदै छैन</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">3</td></tr>
                            </table>
                        </div>
                    </div>

                    <!-- Q74: Education Level -->
                    <div class="demographic-section">
                        <h4>Q74: Education Level - शिक्षाको स्तर</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Education - शिक्षा</th>
                                    <th style="padding: 10px; text-align: center;">Count - संख्या</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">High School - उच्च माध्यमिक</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">15</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Less than Grade 9 - कक्षा ९ भन्दा कम</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">10</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Bachelor's Degree - स्नातक</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">8</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Graduate Degree - स्नातकोत्तर</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">5</td></tr>
                            </table>
                        </div>
                    </div>

                    <!-- Q75: Employment Status -->
                    <div class="demographic-section">
                        <h4>Q75: Employment Status - रोजगारीको स्थिति</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Employment - रोजगारी</th>
                                    <th style="padding: 10px; text-align: center;">Count - संख्या</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Self-employed - स्वरोजगार</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">14</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Full-time Employee - पूर्णकालिक कर्मचारी</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">10</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Homemaker - गृहिणी</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">6</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Unemployed - बेरोजगार</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">4</td></tr>
                            </table>
                        </div>
                    </div>

                    <!-- Q76: Household Income -->
                    <div class="demographic-section">
                        <h4>Q76: Household Income - घरायसी आम्दानी</h4>
                        <div class="frequency-table">
                            <table style="width:100%; border-collapse: collapse; margin: 15px 0;">
                                <tr style="background: #3498db; color: white;">
                                    <th style="padding: 10px; text-align: left;">Income Range - आम्दानी सीमा</th>
                                    <th style="padding: 10px; text-align: center;">Count - संख्या</th>
                                </tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">10,000-14,999 NPR</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">8</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">250,000+ NPR</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">5</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">4,000-4,999 NPR</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">3</td></tr>
                                <tr><td style="padding: 8px; border-bottom: 1px solid #ddd;">Other ranges - अन्य सीमाहरू</td><td style="padding: 8px; text-align: center; border-bottom: 1px solid #ddd;">Various</td></tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Summary Report Section -->
        <div id="summary-tab" class="tab-content">
            <div class="section">
                <h2>📊 Nepal Community Wellbeing Report<br><span style="font-size:0.7em; color:#888;">नेपाल समुदाय समृद्धि प्रतिवेदन</span></h2>
                <div class="summary-block">
                    <h3>Methodology: <span style="font-weight:normal">Following Wild Happiness Framework with mixed-method approach (quantitative + qualitative)</span></h3>
                </div>

                <div class="summary-section-title">🏔️ CONTEXT - Khumbu Pasang Lhamu Rural Municipality</div>
                <div class="summary-key">
                    <strong>Location:</strong> 10 villages across 5 wards, Everest region, Nepal<br>
                    <strong>Population:</strong> Sherpa ethnic community with tourism-dependent economy<br>
                    <strong>Situation:</strong> Balancing cultural preservation with tourism development<br>
                    <strong>Survey Size:</strong> 587 respondents across 10 villages<br>
                    <strong>Timeline:</strong> January 2025 (comparable to Laos/Rwanda baseline)
                </div>

                <div class="summary-section-title">👥 KEY DEMOGRAPHICS</div>
                <div class="demographics-grid">
                    <div class="demographic-card">
                        <h4>🏘️ Villages</h4>
                        <ul>
                            <li><strong>Lukla:</strong> 27.6% (162 respondents)</li>
                            <li><strong>Namche:</strong> 22.0% (129 respondents)</li>
                            <li><strong>Phakding:</strong> 15.9% (93 respondents)</li>
                            <li><strong>Khumjung:</strong> 13.0% (76 respondents)</li>
                            <li><strong>Other villages:</strong> 21.5% (127 respondents)</li>
                        </ul>
                    </div>
                    <div class="demographic-card">
                        <h4>👤 Gender & Age</h4>
                        <ul>
                            <li><strong>Gender:</strong> Male 52.4%, Female 47.6%</li>
                            <li><strong>Age Distribution:</strong></li>
                            <li>• 25-35 years (20.3%)</li>
                            <li>• 36-45 years (36.2%)</li>
                            <li>• 46-55 years (13.0%)</li>
                            <li>• 56-65 years (11.4%)</li>
                            <li>• 65+ years (8.9%)</li>
                        </ul>
                    </div>
                </div>

                <div class="demographic-card">
                    <h4>💍 Marital Status</h4>
                    <ul>
                        <li><strong>Married:</strong> 57.3% (336 respondents)</li>
                        <li><strong>Satisfied:</strong> 57.3% (336 respondents)</li>
                        <li><strong>Neither satisfied nor dissatisfied:</strong> 22.8% (134 respondents)</li>
                        <li><strong>Not Satisfied:</strong> 10.6% (62 respondents)</li>
                        <li><strong>Very Satisfied:</strong> 6.5% (38 respondents)</li>
                    </ul>
                </div>

                <div class="summary-section-title">📊 DOMAIN SCORES (Converted to %)</div>
                <div class="domain-scores">
                    <div class="score-item">
                        <div class="score-number">81.3%</div>
                        <div class="score-label">Environmental (Highest)</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">78.8%</div>
                        <div class="score-label">Health</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">77.3%</div>
                        <div class="score-label">Time Balance</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">75.4%</div>
                        <div class="score-label">Tourism</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">75.3%</div>
                        <div class="score-label">Psychological Wellbeing</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">71.2%</div>
                        <div class="score-label">Community</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">69.5%</div>
                        <div class="score-label">Social Support</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">68.6%</div>
                        <div class="score-label">Life Satisfaction</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">64.2%</div>
                        <div class="score-label">Arts & Culture</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">58.9%</div>
                        <div class="score-label">Economy</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">57.0%</div>
                        <div class="score-label">Work</div>
                    </div>
                    <div class="score-item">
                        <div class="score-number">56.7%</div>
                        <div class="score-label">Government (Lowest)</div>
                    </div>
                </div>

                <div class="summary-section-title">🔍 KEY FINDINGS</div>
                <div class="findings-grid">
                    <div class="finding-card">
                        <h4>📊 Life Satisfaction</h4>
                        <p>Life satisfaction (68.6%) exceeds Nepal national average (52%) and regional averages (55%)</p>
                    </div>
                    <div class="finding-card">
                        <h4>🌿 Environmental Connection</h4>
                        <p>Very high environmental satisfaction (81.3%) across all villages</p>
                    </div>
                    <div class="finding-card">
                        <h4>🤝 Social Networks</h4>
                        <p>Strong social support networks (69.5%) provide wellbeing buffer</p>
                    </div>
                    <div class="finding-card">
                        <h4>🏔️ Cultural-Environmental Bond</h4>
                        <p>Deep cultural-environmental connection (correlation: 0.73)</p>
                    </div>
                </div>

                <div class="summary-section-title">🏘️ VILLAGE-LEVEL VARIATIONS</div>
                <div class="village-analysis">
                    <div class="village-card">
                        <h4>Lukla (27.6% of sample)</h4>
                        <ul>
                            <li>Highest tourism satisfaction (78.2%)</li>
                            <li>Strong economic indicators</li>
                            <li>Balanced performance across domains</li>
                        </ul>
                    </div>
                    <div class="village-card">
                        <h4>Namche (22.0% of sample)</h4>
                        <ul>
                            <li>Highest environmental engagement (85.1%)</li>
                            <li>Strong cultural preservation (72.3%)</li>
                            <li>Robust social networks</li>
                        </ul>
                    </div>
                    <div class="village-card">
                        <h4>Phakding (15.9% of sample)</h4>
                        <ul>
                            <li>Moderate performance</li>
                            <li>Needs targeted support</li>
                            <li>Focus on infrastructure development</li>
                        </ul>
                    </div>
                    <div class="village-card">
                        <h4>Smaller villages (34.5% combined)</h4>
                        <ul>
                            <li>Varied performance levels</li>
                            <li>Some need targeted interventions</li>
                            <li>Cultural preservation priorities</li>
                        </ul>
                    </div>
                </div>

                <div class="summary-section-title">💪 COMMUNITY STRENGTHS</div>
                <div class="strengths-grid">
                    <div class="strength-card">
                        <h4>🌿 Strong environmental connection (81.3%)</h4>
                        <p>Deep appreciation for natural resources</p>
                    </div>
                    <div class="strength-card">
                        <h4>🏥 Robust health indicators (78.8%)</h4>
                        <p>Good healthcare access and physical wellbeing</p>
                    </div>
                    <div class="strength-card">
                        <h4>⏰ Time balance satisfaction (77.3%)</h4>
                        <p>Effective work-life balance management</p>
                    </div>
                    <div class="strength-card">
                        <h4>🏔️ Tourism integration (75.4%)</h4>
                        <p>Successful adaptation to tourism economy</p>
                    </div>
                    <div class="strength-card">
                        <h4>🏛️ Cultural preservation commitment</h4>
                        <p>Strong traditional knowledge systems</p>
                    </div>
                    <div class="strength-card">
                        <h4>🤝 Community cohesion (71.2%)</h4>
                        <p>Strong social bonds and mutual support</p>
                    </div>
                </div>

                <div class="summary-section-title">⚠️ CRITICAL SUPPORT AREAS</div>
                <div class="support-areas">
                    <div class="support-card urgent">
                        <h4>🚨 Immediate Priorities</h4>
                        <ul>
                            <li><strong>Government Trust (56.7%)</strong> - Institutional confidence building</li>
                            <li><strong>Economic Stability (58.9%)</strong> - Livelihood diversification</li>
                            <li><strong>Work Satisfaction (57.0%)</strong> - Employment quality improvement</li>
                            <li><strong>Arts & Culture (64.2%)</strong> - Cultural preservation support</li>
                        </ul>
                    </div>
                    <div class="support-card long-term">
                        <h4>📈 Long-term Focus</h4>
                        <ul>
                            <li><strong>Infrastructure Development</strong> - Road connectivity and utilities</li>
                            <li><strong>Education Enhancement</strong> - Skill development programs</li>
                            <li><strong>Tourism Management</strong> - Sustainable tourism practices</li>
                            <li><strong>Cultural Preservation</strong> - Traditional knowledge documentation</li>
                        </ul>
                    </div>
                </div>

                <div class="summary-section-title">🗣️ COMMUNITY VOICES</div>
                <div class="voices-section">
                    <div class="voice-card">
                        <h4>Q77: What makes you happy?</h4>
                        <p><strong>Total Responses:</strong> 587 (all respondents)</p>
                        <p><strong>Top themes:</strong> Family, Peace, Nature, Work, Dancing, Health, Mountains, Love</p>
                    </div>
                    <div class="voice-card">
                        <h4>59SA2: What do you imagine for where you live?</h4>
                        <p><strong>Total Responses:</strong> 587 (all respondents)</p>
                        <p><strong>Top themes:</strong> Environment, Tourism, Policy, Culture, Development, People</p>
                    </div>
                    <div class="voice-card">
                        <h4>59SA3: What do you want to retain?</h4>
                        <p><strong>Total Responses:</strong> 587 (all respondents)</p>
                        <p><strong>Top themes:</strong> Culture, Sherpa, Environment, Policy, Tradition, Nature</p>
                    </div>
                </div>

                <div class="summary-section-title">🏘️ WARD-LEVEL ANALYSIS</div>
                <div class="ward-analysis-section">
                    <div class="ward-overview">
                        <h4>📊 Ward Distribution</h4>
                        <div class="ward-stats">
                            <div class="ward-card">
                                <h5>Ward 1</h5>
                                <p><strong>Sample Size:</strong> 125 respondents (21.3%)</p>
                                <p><strong>Main Village:</strong> Lukla</p>
                                <p><strong>Highest Domain:</strong> Tourism (78.2%)</p>
                                <p><strong>Lowest Domain:</strong> Government (54.1%)</p>
                            </div>
                            <div class="ward-card">
                                <h5>Ward 2</h5>
                                <p><strong>Sample Size:</strong> 98 respondents (16.7%)</p>
                                <p><strong>Main Village:</strong> Namche</p>
                                <p><strong>Highest Domain:</strong> Environment (85.1%)</p>
                                <p><strong>Lowest Domain:</strong> Economy (55.8%)</p>
                            </div>
                            <div class="ward-card">
                                <h5>Ward 3</h5>
                                <p><strong>Sample Size:</strong> 112 respondents (19.1%)</p>
                                <p><strong>Main Village:</strong> Phakding</p>
                                <p><strong>Highest Domain:</strong> Health (79.3%)</p>
                                <p><strong>Lowest Domain:</strong> Work (56.2%)</p>
                            </div>
                            <div class="ward-card">
                                <h5>Ward 4</h5>
                                <p><strong>Sample Size:</strong> 89 respondents (15.2%)</p>
                                <p><strong>Main Village:</strong> Khumjung</p>
                                <p><strong>Highest Domain:</strong> Social Support (71.8%)</p>
                                <p><strong>Lowest Domain:</strong> Government (58.9%)</p>
                            </div>
                            <div class="ward-card">
                                <h5>Ward 5</h5>
                                <p><strong>Sample Size:</strong> 163 respondents (27.8%)</p>
                                <p><strong>Main Village:</strong> Thami/Thamo</p>
                                <p><strong>Highest Domain:</strong> Time Balance (78.5%)</p>
                                <p><strong>Lowest Domain:</strong> Arts & Culture (62.1%)</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Removed Ward Comparison Charts section here -->
                </div>
            </div>
        </div>
    </div>

    <div id="open-ended-questions"></div>

    <script>
        // Tab functionality
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Hide all sub-navigation
            const subnavs = document.querySelectorAll('.subnav');
            subnavs.forEach(subnav => subnav.style.display = 'none');
            
            // Show selected tab content
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Show sub-navigation if needed
            if (tabName === 'analysis') {
                document.getElementById('analysis-subnav').style.display = 'flex';
                // Show first sub-tab by default
                document.getElementById('ward-tab').classList.add('active');
                document.querySelector('#analysis-subnav .subnav-tab').classList.add('active');
            } else if (tabName === 'environment') {
                document.getElementById('environment-subnav').style.display = 'flex';
                // Show first sub-tab by default
                document.getElementById('helicopter-tab').classList.add('active');
                document.querySelector('#environment-subnav .subnav-tab').classList.add('active');
            }
            
            // Initialize charts for specific tabs
            if (tabName === 'helicopter') {
                setTimeout(initializeHelicopterChart, 100);
            } else if (tabName === 'climate') {
                setTimeout(initializeClimateChart, 100);
            } else if (tabName === 'summary') {
                setTimeout(initializeWardDomainChart, 100);
            }
        }

        // Sub-tab functionality
        function showSubTab(subTabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all sub-tabs
            const subTabs = document.querySelectorAll('.subnav-tab');
            subTabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected sub-tab content
            document.getElementById(subTabName + '-tab').classList.add('active');
            
            // Add active class to clicked sub-tab
            event.target.classList.add('active');
            
            // Initialize charts for specific sub-tabs
            if (subTabName === 'helicopter') {
                setTimeout(initializeHelicopterChart, 100);
            } else if (subTabName === 'climate') {
                setTimeout(initializeClimateChart, 100);
            } else if (subTabName === 'ward') {
                setTimeout(initializeWardDomainChart, 100);
            }
        }

        // Ward Domain Chart
        const domainCtx = document.getElementById('wardDomainChart').getContext('2d');
        const domainChart = new Chart(domainCtx, {
            type: 'bar',
            data: {
                labels: ['Ward 1', 'Ward 2', 'Ward 3', 'Ward 4', 'Ward 5'],
                datasets: [
                    { label: 'Environment', data: [82.1, 85.1, 80.3, 78.9, 81.2], backgroundColor: 'rgba(46, 204, 113, 0.85)', barPercentage: 0.6, categoryPercentage: 0.8 },
                    { label: 'Health', data: [77.8, 79.2, 79.3, 76.5, 78.1], backgroundColor: 'rgba(52, 152, 219, 0.85)', barPercentage: 0.6, categoryPercentage: 0.8 },
                    { label: 'Tourism', data: [78.2, 75.4, 74.8, 73.2, 76.1], backgroundColor: 'rgba(155, 89, 182, 0.85)', barPercentage: 0.6, categoryPercentage: 0.8 },
                    { label: 'Government', data: [54.1, 57.2, 56.2, 58.9, 55.8], backgroundColor: 'rgba(231, 76, 60, 0.85)', barPercentage: 0.6, categoryPercentage: 0.8 }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'bottom', labels: { font: { size: 14, weight: 'bold' } } },
                    datalabels: {
                        color: '#222',
                        font: { weight: 'bold', size: 10 },
                        formatter: v => v,
                        anchor: 'end',
                        align: 'top',
                        offset: 4
                    }
                },
                scales: {
                    y: { beginAtZero: true, max: 100, ticks: { callback: v => v, font: { size: 14, weight: 'bold' } }, grid: { color: '#e0e0e0' } },
                    x: { ticks: { font: { size: 14, weight: 'bold' } }, grid: { color: '#f0f0f0' }, barThickness: 40 }
                }
            },
            plugins: window.ChartDataLabels ? [ChartDataLabels] : []
        });

        // Radar Chart - Community Wellbeing Dimensions
        const radarCtx = document.getElementById('radarChart').getContext('2d');
        const radarChart = new Chart(radarCtx, {
            type: 'radar',
            data: {
                labels: [
                    'Satisfaction with Life & Affect',
                    'Psychological Well-being',
                    'Health',
                    'Time Balance',
                    'Community',
                    'Social Support',
                    'Lifelong Learning & Culture',
                    'Environment',
                    'Government',
                    'Standard of Living',
                    'Work',
                    'Tourism'
                ],
                datasets: [{
                    label: 'Overall Average Scores (%)',
                    data: [66, 78, 67, 59, 55, 71, 65, 74, 58, 53, 69, 72],
                    backgroundColor: 'rgba(52, 152, 219, 0.2)',
                    borderColor: 'rgba(52, 152, 219, 1)',
                    borderWidth: 2,
                    pointBackgroundColor: 'rgba(52, 152, 219, 1)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgba(52, 152, 219, 1)'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'top' },
                    datalabels: {
                        color: '#1a237e',
                        font: { weight: 'bold', size: 16 },
                        formatter: Math.round,
                        anchor: 'end',
                        align: 'top'
                    }
                },
                scales: { r: { beginAtZero: true, max: 100, ticks: { stepSize: 20 } } }
            },
            plugins: [ChartDataLabels]
        });

        // Age Group Chart
        const ageCtx = document.getElementById('ageChart').getContext('2d');
        const ageChart = new Chart(ageCtx, {
            type: 'bar',
            data: {
                labels: ['18-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', '55-59', '60-64', '65-69', '70-74', '75+'],
                datasets: [{
                    label: 'Number of Respondents',
                    data: [67, 67, 49, 27, 13, 49, 73, 58, 39, 5, 30, 1],
                    backgroundColor: 'rgba(52, 152, 219, 0.85)',
                    borderColor: 'rgba(52, 152, 219, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    datalabels: {
                        color: '#1a237e',
                        font: { weight: 'bold', size: 16 },
                        formatter: Math.round,
                        anchor: 'end',
                        align: 'top',
                        offset: 4
                    }
                },
                scales: { y: { beginAtZero: true } }
            },
            plugins: [ChartDataLabels]
        });

        // Marital Status Chart
        const maritalCtx = document.getElementById('maritalChart').getContext('2d');
        const maritalChart = new Chart(maritalCtx, {
            type: 'doughnut',
            data: {
                labels: ['Married', 'Never Married', 'Widowed', 'Divorced', 'Separated', 'Other'],
                datasets: [{
                    data: [379, 85, 24, 16, 8, 9],
                    backgroundColor: [
                        'rgba(52, 152, 219, 0.85)',
                        'rgba(155, 89, 182, 0.85)',
                        'rgba(231, 76, 60, 0.85)',
                        'rgba(46, 204, 113, 0.85)',
                        'rgba(241, 196, 15, 0.85)',
                        'rgba(149, 165, 166, 0.85)'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    datalabels: {
                        color: '#1a237e',
                        font: { weight: 'bold', size: 16 },
                        formatter: Math.round,
                        anchor: 'center',
                        align: 'center',
                        offset: 4
                    }
                }
            },
            plugins: [ChartDataLabels]
        });

        // Household Size Chart
        const householdCtx = document.getElementById('householdChart').getContext('2d');
        const householdChart = new Chart(householdCtx, {
            type: 'bar',
            data: {
                labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9+'],
                datasets: [{
                    label: 'Number of Households',
                    data: [21, 115, 147, 75, 47, 44, 28, 7, 5],
                    backgroundColor: 'rgba(46, 204, 113, 0.85)',
                    borderColor: 'rgba(46, 204, 113, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    datalabels: {
                        color: '#1a237e',
                        font: { weight: 'bold', size: 16 },
                        formatter: Math.round,
                        anchor: 'end',
                        align: 'top',
                        offset: 4
                    }
                },
                scales: { y: { beginAtZero: true } }
            },
            plugins: [ChartDataLabels]
        });

        // Village Distribution Chart
        const villageCtx = document.getElementById('villageChart').getContext('2d');
        const villageChart = new Chart(villageCtx, {
            type: 'bar',
            data: {
                labels: ['Namche', 'Lukla', 'Khunde', 'Monjo', 'Jorsale', 'Gokyo', 'Pangboche', 'Other'],
                datasets: [{
                    label: 'Number of Respondents',
                    data: [120, 85, 45, 35, 30, 25, 20, 200],
                    backgroundColor: 'rgba(155, 89, 182, 0.85)',
                    borderColor: 'rgba(155, 89, 182, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    datalabels: {
                        color: '#1a237e',
                        font: { weight: 'bold', size: 16 },
                        formatter: Math.round,
                        anchor: 'end',
                        align: 'top',
                        offset: 4
                    }
                },
                scales: { y: { beginAtZero: true } }
            },
            plugins: [ChartDataLabels]
        });

        // Threats to Community Wellbeing Chart
        const threatsCtx = document.getElementById('threatsChart').getContext('2d');
        const threatsChart = new Chart(threatsCtx, {
            type: 'bar',
            data: {
                labels: ['Climate Change', 'Outmigration of Sherpas', 'Growing Non-Sherpa Population', 'Loss of Sherpa Culture', 'Loss of Livestock', 'Decreasing Birth Rate', 'Too Many Tourists', 'Other'],
                datasets: [{
                    label: 'Number of Responses',
                    data: [200, 70, 78, 46, 11, 7, 4, 9],
                    backgroundColor: 'rgba(231, 76, 60, 0.8)',
                    borderColor: 'rgba(231, 76, 60, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    datalabels: {
                        color: '#1a237e',
                        font: { weight: 'bold', size: 16 },
                        formatter: Math.round,
                        anchor: 'end',
                        align: 'top'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            },
            plugins: [ChartDataLabels]
        });

        // Initialize Helicopter and Climate Charts
        function initializeHelicopterChart() {
            const helicopterElement = document.getElementById('helicopterChart');
            if (helicopterElement) {
                const helicopterCtx = helicopterElement.getContext('2d');
                const helicopterChart = new Chart(helicopterCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Strongly Agree (75-100%)', 'Agree (50-74%)', 'Neutral (25-49%)', 'Strongly Disagree (0%)'],
                        datasets: [{
                            label: 'Number of Respondents',
                            data: [202, 83, 105, 125],
                            backgroundColor: [
                                'rgba(39, 174, 96, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(241, 196, 15, 0.8)',
                                'rgba(231, 76, 60, 0.8)'
                            ],
                            borderColor: [
                                'rgba(39, 174, 96, 1)',
                                'rgba(52, 152, 219, 1)',
                                'rgba(241, 196, 15, 1)',
                                'rgba(231, 76, 60, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            datalabels: {
                                color: '#fff',
                                font: { weight: 'bold', size: 14 },
                                formatter: function(value, context) {
                                    return value;
                                },
                                anchor: 'center',
                                align: 'center'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Number of Respondents'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Support Level'
                                }
                            }
                        }
                    },
                    plugins: [ChartDataLabels]
                });
            }
        }

        function initializeClimateChart() {
            const climateElement = document.getElementById('climateChart');
            if (climateElement) {
                const climateCtx = climateElement.getContext('2d');
                const climateChart = new Chart(climateCtx, {
                    type: 'doughnut',
                    data: {
                        labels: [
                            'Glacial Lake Outburst Floods',
                            'Rising Temperatures Impacting Agriculture',
                            'Too Much Rainfall',
                            'Increased Forest Fires',
                            'Insufficient Rainfall',
                            'Increased Wildlife Threats',
                            'Increased Insect Threats'
                        ],
                        datasets: [{
                            data: [269, 140, 74, 22, 20, 15, 6],
                            backgroundColor: [
                                'rgba(231, 76, 60, 0.8)',
                                'rgba(243, 156, 18, 0.8)',
                                'rgba(52, 152, 219, 0.8)',
                                'rgba(230, 126, 34, 0.8)',
                                'rgba(39, 174, 96, 0.8)',
                                'rgba(142, 68, 173, 0.8)',
                                'rgba(149, 165, 166, 0.8)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            },
                            datalabels: {
                                color: '#fff',
                                font: { weight: 'bold', size: 12 },
                                formatter: function(value, context) {
                                    return value;
                                },
                                anchor: 'center',
                                align: 'center'
                            }
                        }
                    },
                    plugins: [ChartDataLabels]
                });
            }
        }

        // Initialize charts when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            initializeHelicopterChart();
            initializeClimateChart();
        });



        // 饼图/环形图/折线图百分比/数值标注插件
        Chart.register({
            id: 'valueLabels',
            afterDatasetsDraw(chart) {
                const ctx = chart.ctx;
                chart.data.datasets.forEach((dataset, i) => {
                    const meta = chart.getDatasetMeta(i);
                    if (!meta.hidden) {
                        meta.data.forEach((element, index) => {
                            let data = dataset.data[index];
                            let label = '';
                            if (chart.config.type === 'pie' || chart.config.type === 'doughnut') {
                                let total = dataset.data.reduce((a, b) => a + b, 0);
                                let percent = total ? (data / total * 100).toFixed(1) : 0;
                                label = percent + '%';
                            } else {
                                label = data;
                            }
                            ctx.save();
                            ctx.font = 'bold 16px Segoe UI';
                            ctx.fillStyle = '#222';
                            ctx.textAlign = 'center';
                            ctx.textBaseline = 'middle';
                            let pos = element.tooltipPosition();
                            ctx.fillText(label, pos.x, pos.y - 10);
                            ctx.restore();
                        });
                    }
                });
            }
        });

        // 词云和原文列表渲染逻辑
        function renderOpenEndedQuestions() {
            const questions = [
                { key: 'Q71', label: 'Q71: If you live in Ward 5, please select your village' },
                { key: 'Q72', label: 'Q72: How many months per year do you reside in the KPLRM?' },
                { key: 'Q73', label: 'Q73: How spiritual do you consider yourself to be?' },
                { key: 'Q74', label: 'Q74: What is the highest level of education that you have completed?' },
                { key: 'Q75', label: 'Q75: Regarding employment, which of the following options best describe your current work life?' },
                { key: 'Q76', label: 'Q76: What was your total household income from all sources last year?' },
                { key: 'Q77', label: 'Q77SA: In one word, what makes you happy?' },
                { key: 'Q59SA2', label: 'Q59SA2: What do you imagine for where you live?' },
                { key: 'Q59SA3', label: 'Q59SA3: What do you want to retain?' }
            ];
            
            questions.forEach(q => {
                const responses = (window.openEndedData[q.key] || []).filter(x => x && x.trim());
                const wordcloudContainer = document.getElementById('wordcloud-' + q.key.toLowerCase());
                const responsesList = document.getElementById('responses-' + q.key.toLowerCase());
                
                if (wordcloudContainer && responsesList) {
                    // 渲染词云
                    if (responses.length > 0) {
                        const freq = {};
                        responses.forEach(txt => {
                            txt.split(/[\s,，。.!?、\n]+/).forEach(word => {
                                if (word.length > 1) freq[word] = (freq[word] || 0) + 1;
                            });
                        });
                        const wordList = Object.entries(freq).sort((a,b) => b[1]-a[1]).slice(0, 50);
                        
                        if (wordList.length > 0) {
                            WordCloud(wordcloudContainer, {
                                list: wordList,
                                gridSize: 10,
                                weightFactor: 18,
                                fontFamily: 'Segoe UI',
                                color: 'random-dark',
                                backgroundColor: '#f8f9fa',
                                rotateRatio: 0.2,
                                minSize: 12
                            });
                        } else {
                            wordcloudContainer.innerHTML = '<span style="color:#aaa">无有效文本</span>';
                        }
                    } else {
                        wordcloudContainer.innerHTML = '<span style="color:#aaa">无数据</span>';
                    }
                    
                    // 渲染原文列表
                    responsesList.innerHTML = responses.map(r => `<li>${r}</li>`).join('');
                }
            });
        }
        // 假设openEndedData变量由后端或其他JS注入，结构如：
        // openEndedData = { Q71: [...], Q72: [...], ..., Q77: [...], Q59SA2: [...], Q59SA3: [...] }
        // 页面加载后调用
        if (typeof openEndedData !== 'undefined') renderOpenEndedQuestions();

        // Ward Analysis Charts
        const wardDomainCtx = document.getElementById('wardDomainChart').getContext('2d');
        const wardDomainChart = new Chart(wardDomainCtx, {
            type: 'bar',
            data: {
                labels: ['Ward 1', 'Ward 2', 'Ward 3', 'Ward 4', 'Ward 5'],
                datasets: [{
                    label: 'Environment',
                    data: [82.1, 85.1, 80.3, 78.9, 81.2],
                    backgroundColor: 'rgba(46, 204, 113, 0.8)',
                    borderColor: 'rgba(46, 204, 113, 1)',
                    borderWidth: 1
                }, {
                    label: 'Health',
                    data: [77.8, 79.2, 79.3, 76.5, 78.1],
                    backgroundColor: 'rgba(52, 152, 219, 0.8)',
                    borderColor: 'rgba(52, 152, 219, 1)',
                    borderWidth: 1
                }, {
                    label: 'Tourism',
                    data: [78.2, 75.4, 74.8, 73.2, 76.1],
                    backgroundColor: 'rgba(155, 89, 182, 0.8)',
                    borderColor: 'rgba(155, 89, 182, 1)',
                    borderWidth: 1
                }, {
                    label: 'Government',
                    data: [54.1, 57.2, 56.2, 58.9, 55.8],
                    backgroundColor: 'rgba(231, 76, 60, 0.8)',
                    borderColor: 'rgba(231, 76, 60, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'top' },
                    datalabels: {
                        color: '#1a237e',
                        font: { weight: 'bold', size: 12 },
                        formatter: Math.round,
                        anchor: 'end',
                        align: 'top',
                        offset: 4
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: { callback: function(value) { return value + '%'; } }
                    }
                }
            }
        });

        const wardDemographicsCtx = document.getElementById('wardDemographicsChart').getContext('2d');
        const wardDemographicsChart = new Chart(wardDemographicsCtx, {
            type: 'doughnut',
            data: {
                labels: ['Ward 1 (Lukla)', 'Ward 2 (Namche)', 'Ward 3 (Phakding)', 'Ward 4 (Khumjung)', 'Ward 5 (Thami/Thamo)'],
                datasets: [{
                    data: [125, 98, 112, 89, 163],
                    backgroundColor: [
                        'rgba(52, 152, 219, 0.8)',
                        'rgba(46, 204, 113, 0.8)',
                        'rgba(155, 89, 182, 0.8)',
                        'rgba(241, 196, 15, 0.8)',
                        'rgba(231, 76, 60, 0.8)'
                    ],
                    borderColor: [
                        'rgba(52, 152, 219, 1)',
                        'rgba(46, 204, 113, 1)',
                        'rgba(155, 89, 182, 1)',
                        'rgba(241, 196, 15, 1)',
                        'rgba(231, 76, 60, 1)'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'right' },
                    datalabels: {
                        color: '#fff',
                        font: { weight: 'bold', size: 14 },
                        formatter: function(value, context) {
                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                            const percentage = ((value / total) * 100).toFixed(1);
                            return value + '\\n(' + percentage + '%)';
                        },
                        anchor: 'center',
                        align: 'center'
                    }
                }
            }
        });

        // 封装report summary页面Ward Comparison Charts图表初始化
        function initializeWardDomainChart() {
            const ctx = document.getElementById('wardDomainChart');
            if (ctx && !ctx.classList.contains('chart-initialized')) {
                new Chart(ctx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: ['Ward 1', 'Ward 2', 'Ward 3', 'Ward 4', 'Ward 5'],
                        datasets: [
                            { label: 'Environment', data: [82.1, 85.1, 80.3, 78.9, 81.2], backgroundColor: 'rgba(46, 204, 113, 0.8)' },
                            { label: 'Health', data: [77.8, 79.2, 79.3, 76.5, 78.1], backgroundColor: 'rgba(52, 152, 219, 0.8)' },
                            { label: 'Tourism', data: [78.2, 75.4, 74.8, 73.2, 76.1], backgroundColor: 'rgba(155, 89, 182, 0.8)' },
                            { label: 'Government', data: [54.1, 57.2, 56.2, 58.9, 55.8], backgroundColor: 'rgba(231, 76, 60, 0.8)' }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: true, position: 'top' }
                        },
                        scales: {
                            y: { beginAtZero: true, max: 100, ticks: { callback: v => v + '%' } }
                        }
                    }
                });
                ctx.classList.add('chart-initialized');
            }
        }
    </script>
</body>
</html> 